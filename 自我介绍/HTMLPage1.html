<!-- HTMLPage1.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人主页</title>
    <style>
    /* 全局样式 */
    body, html {
        margin: 0;
        padding: 0;
        font-family: 'Roboto', sans-serif;
        background: url('background.jpg') no-repeat center center/cover;
        /*filter: blur(10px);*/  /* 注释掉这一行以消除模糊效果 */
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        color: #333;
    }

    /* 其他样式 */
    main {
        padding: 20px;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        border-radius: 16px;
    }

    .welcome {
        margin-bottom: 20px;
    }

    .profile-picture {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 20px;
    }

    .intro {
        margin-bottom: 20px;
    }

    .contact {
        margin-bottom: 20px;
    }

    .contact-item {
        display: block;
        margin: 10px 0;
        color: #333;
        text-decoration: none;
        transition: color 0.3s ease-in-out;
    }

    .contact-item:hover {
        color: #5cb85c;
        cursor: pointer;
    }
       footer
{
    background: rgba(255, 255, 255, 0.8);
   /* color: #333; */
    padding: 20px;
    position: absolute;
    bottom: 0;
    width: 100%;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    border-radius: 16px;
    backdrop-filter: blur(8px);
}

footer p {
    margin: 0;
    padding: 0;
    font-size: 14px;
    font-family: 'Roboto', sans-serif;
}

#aiButton {
    padding: 10px 20px;
    background: #5cb85c;
    color: #fff;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease-in-out;
    font-family: 'Roboto', sans-serif;
}

    #aiButton:hover {
        background: #4cae4c;
    }

#closeAi {
    float: right;
    background: #f0f0f0;
    border: none;
    cursor: pointer;
    font-family: 'Roboto', sans-serif;
}

    #closeAi:hover {
        background: #e0e0e0;
    }


</style>


</head>
<body>
    <div class="bg"></div>
    <main>
        <section class="welcome">
            <img src="avatar.jpg" alt="头像" class="profile-picture">
            <h1>欢迎来到我的个人主页</h1>
        </section>
        <section class="intro">
            <h2>个人简介</h2>
            <p>这里是简短的个人介绍，可以包含我的兴趣爱好、职业目标等。</p>
        </section>
        <section class="contact">
            <h2>联系方式</h2>
            <a href="mailto:example@example.com" class="contact-item">example@example.com</a>
            <a href="https://twitter.com/example" class="contact-item" target="_blank">Twitter</a>
            <a href="https://github.com/example" class="contact-item" target="_blank">GitHub</a>
        </section>
    </main>
<footer>
    <p>&copy; 2024 版权所有</p>
    <div id="aiChat" class="ai-chat">
        <div class="chat-header">
            <h3>AI 对话</h3>
            <button id="closeAi">关闭</button>
        </div>
        <div class="chat-body">
            <div id="chatMessages"></div>
            <input type="text" id="userInput" placeholder="输入消息...">
            <button id="sendButton">发送</button>
        </div>
    </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // script.js
        document.addEventListener('DOMContentLoaded', function () {
            const aiButton = document.getElementById('aiButton');
            const aiChat = document.getElementById('aiChat');
            const closeAi = document.getElementById('closeAi');
            const chatMessages = document.getElementById('chatMessages');
            const userInput = document.getElementById('userInput');
            const sendButton = document.getElementById('sendButton');

            aiButton.onclick = function () {
                aiChat.style.display = 'block';
            };

            closeAi.onclick = function () {
                aiChat.style.display = 'none';
            };

            sendButton.onclick = function () {
                const userText = userInput.value;
                if (userText.trim() === '') return;

                const div = document.createElement('div');
                div.textContent = userText;
                chatMessages.appendChild(div);

                // 清空输入框
                userInput.value = '';

                // 调用API
                callAiApi(userText);
            };

            function callAiApi(userText) {
                fetch('http://localhost:3000/ai/v2/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        question: userText
                    }),
                    mode: 'cors',
                })
                    .then(response => response.json())
                    .then(data => {
                        const div = document.createElement('div');
                        div.textContent = data.answer; // 假设返回的数据包含answer字段
                        chatMessages.appendChild(div);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }
        });

        // api.js
        function fetchData(url) {
            return new Promise((resolve, reject) => {
                fetch(url)
                    .then
.then(response => response.json())
                        .then(data => resolve(data))
                        .catch(error => reject(error));
            });
        }

        function callAiApi(userText) {
            const url = 'http://localhost:3000/ai/v2/chat';
            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    question: userText
                }),
                mode: 'cors',
            };

            fetchData(url, options)
                .then(data => {
                    const div = document.createElement('div');
                    div.textContent = data.answer; // 假设返回的数据包含answer字段
                    chatMessages.appendChild(div);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        // cors.js
        function enableCors() {
            const origin = '*';
            const methods = 'GET, POST, PUT, DELETE, OPTIONS';
            const headers = 'Content-Type, Authorization';

            if (window.location.origin === origin) {
                return;
            }

            const script = document.createElement('script');
            script.src = `https://cors-anywhere.herokuapp.com/${origin}/${methods}/${headers}`;
            script.crossOrigin = 'anonymous';
            script.async = true;
            script.onload = () => {
                if (window.corsAnywhere) {
                    window.corsAnywhere.enable();
                }
            };
            document.head.appendChild(script);
        }

        // main.js
        function main() {
            enableCors();

            const aiButton = document.getElementById('aiButton');
            const aiChat = document.getElementById('aiChat');
            const closeAi = document.getElementById('closeAi');
            const chatMessages = document.getElementById('chatMessages');
            const userInput = document.getElementById('userInput');
            const sendButton = document.getElementById('sendButton');

            aiButton.onclick = function () {
                aiChat.style.display = 'block';
            };

            closeAi.onclick = function () {
                aiChat.style.display = 'none';
            };

            sendButton.onclick = function () {
                const userText = userInput.value;
                if (userText.trim() === '') return;

                const div = document.createElement('div');
                div.textContent = userText;
                chatMessages.appendChild(div);

                // 清空输入框
                userInput.value = '';

                // 调用API
                callAiApi(userText);
            };
        }

        main();
    </script>
</body>
</html>
